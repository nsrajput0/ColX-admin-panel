<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ColX Admin Panel - Enhanced Responsive Firebase Management</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --neon-blue: #00f5ff;
            --neon-purple: #bf00ff;
            --neon-pink: #ff0080;
            --neon-green: #00ff41;
            --neon-orange: #ff6600;
            --dark-bg: #0a0a0a;
            --card-bg: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --border-color: rgba(0, 245, 255, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(0, 245, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(191, 0, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255, 0, 128, 0.1) 0%, transparent 50%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .orbitron {
            font-family: 'Orbitron', monospace;
        }

        .neon-glow {
            text-shadow: 0 0 5px currentColor, 0 0 10px currentColor, 0 0 15px currentColor;
            animation: pulse-glow 2s ease-in-out infinite alternate;
        }

        @keyframes pulse-glow {
            from { text-shadow: 0 0 5px currentColor, 0 0 10px currentColor, 0 0 15px currentColor; }
            to { text-shadow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 30px currentColor; }
        }

        .cyber-border {
            border: 1px solid var(--border-color);
            background: rgba(26, 26, 26, 0.9);
            box-shadow: 0 0 10px rgba(0, 245, 255, 0.3);
            backdrop-filter: blur(10px);
        }

        .cyber-card {
            background: rgba(26, 26, 26, 0.9);
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .cyber-card:hover {
            border-color: var(--neon-blue);
            box-shadow: 0 0 20px rgba(0, 245, 255, 0.2);
            transform: translateY(-2px);
        }

        .cyber-input, .cyber-select, .cyber-textarea {
            background: rgba(26, 26, 26, 0.9);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 12px 16px;
            font-family: 'Rajdhani', sans-serif;
            transition: all 0.3s ease;
            border-radius: 6px;
            font-size: 16px;
            width: 100%;
        }

        .cyber-input:focus, .cyber-select:focus, .cyber-textarea:focus {
            outline: none;
            border-color: var(--neon-blue);
            box-shadow: 0 0 10px rgba(0, 245, 255, 0.3);
            background: rgba(26, 26, 26, 0.95);
        }

        .cyber-select option {
            background: var(--card-bg);
            color: var(--text-primary);
        }

        .neon-button {
            background: transparent;
            border: 2px solid var(--neon-blue);
            color: var(--neon-blue);
            padding: 12px 24px;
            font-family: 'Orbitron', monospace;
            font-weight: 600;
            text-transform: uppercase;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            border-radius: 6px;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            white-space: nowrap;
            min-height: 44px;
        }

        .neon-button:hover {
            background: var(--neon-blue);
            color: var(--dark-bg);
            box-shadow: 0 0 20px var(--neon-blue);
            transform: translateY(-2px);
        }

        .neon-button:active {
            transform: translateY(0);
        }

        .neon-button.purple {
            border-color: var(--neon-purple);
            color: var(--neon-purple);
        }

        .neon-button.purple:hover {
            background: var(--neon-purple);
            color: var(--dark-bg);
            box-shadow: 0 0 20px var(--neon-purple);
        }

        .neon-button.green {
            border-color: var(--neon-green);
            color: var(--neon-green);
        }

        .neon-button.green:hover {
            background: var(--neon-green);
            color: var(--dark-bg);
            box-shadow: 0 0 20px var(--neon-green);
        }

        .neon-button.pink {
            border-color: var(--neon-pink);
            color: var(--neon-pink);
        }

        .neon-button.pink:hover {
            background: var(--neon-pink);
            color: var(--dark-bg);
            box-shadow: 0 0 20px var(--neon-pink);
        }

        .neon-button.orange {
            border-color: var(--neon-orange);
            color: var(--neon-orange);
        }

        .neon-button.orange:hover {
            background: var(--neon-orange);
            color: var(--dark-bg);
            box-shadow: 0 0 20px var(--neon-orange);
        }

        .nav-link {
            position: relative;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            cursor: pointer;
            padding: 12px 20px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            min-height: 44px;
        }

        .nav-link:hover,
        .nav-link.active {
            color: var(--neon-blue);
            text-shadow: 0 0 10px var(--neon-blue);
            background: rgba(0, 245, 255, 0.1);
        }

        .mobile-nav {
            display: none;
        }

        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 8px;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background: var(--neon-blue);
            margin: 3px 0;
            transition: 0.3s;
        }

        @media (max-width: 768px) {
            .desktop-nav {
                display: none;
            }

            .hamburger {
                display: flex;
            }

            .mobile-nav {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(26, 26, 26, 0.95);
                border: 1px solid var(--border-color);
                border-top: none;
                backdrop-filter: blur(10px);
                z-index: 1000;
            }

            .mobile-nav.active {
                display: block;
            }

            .mobile-nav .nav-link {
                display: block;
                padding: 16px 20px;
                border-bottom: 1px solid var(--border-color);
            }

            .mobile-nav .nav-link:last-child {
                border-bottom: none;
            }
        }

        .stat-card {
            background: rgba(26, 26, 26, 0.9);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple), var(--neon-pink));
        }

        .stat-card:hover {
            border-color: var(--neon-blue);
            box-shadow: 0 0 20px rgba(0, 245, 255, 0.2);
            transform: translateY(-4px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 8px;
            display: block;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(26, 26, 26, 0.9);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .data-table th,
        .data-table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid rgba(0, 245, 255, 0.1);
            font-size: 14px;
        }

        .data-table th {
            background: rgba(0, 245, 255, 0.1);
            color: var(--neon-blue);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .data-table tr:hover {
            background: rgba(0, 245, 255, 0.05);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        @media (max-width: 768px) {
            .data-table {
                font-size: 12px;
            }

            .data-table th,
            .data-table td {
                padding: 12px 8px;
            }
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--neon-blue);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid var(--neon-green);
            border-radius: 8px;
            color: var(--neon-green);
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            font-size: 14px;
            max-width: 300px;
            backdrop-filter: blur(10px);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            border-color: var(--neon-pink);
            color: var(--neon-pink);
        }

        .notification.warning {
            border-color: var(--neon-orange);
            color: var(--neon-orange);
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge.approved {
            background: rgba(0, 255, 65, 0.2);
            color: var(--neon-green);
            border: 1px solid var(--neon-green);
        }

        .badge.pending {
            background: rgba(255, 165, 0, 0.2);
            color: var(--neon-orange);
            border: 1px solid var(--neon-orange);
        }

        .badge.verified {
            background: rgba(0, 245, 255, 0.2);
            color: var(--neon-blue);
            border: 1px solid var(--neon-blue);
        }

        .badge.implemented {
            background: rgba(191, 0, 255, 0.2);
            color: var(--neon-purple);
            border: 1px solid var(--neon-purple);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-label {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
        }

        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
            padding: 20px;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease-in-out;
        }

        .modal-content {
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid var(--neon-blue);
            border-radius: 12px;
            padding: 32px;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            backdrop-filter: blur(10px);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--neon-blue);
        }

        .close-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            color: var(--neon-pink);
            background: rgba(255, 0, 128, 0.1);
        }

        .search-container {
            position: relative;
            margin-bottom: 20px;
        }

        .search-input {
            padding-left: 50px;
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
            background: rgba(26, 26, 26, 0.5);
            border-radius: 12px;
            padding: 20px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .filter-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .filter-tag {
            background: rgba(0, 245, 255, 0.1);
            color: var(--neon-blue);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            border: 1px solid var(--neon-blue);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-tag:hover,
        .filter-tag.active {
            background: var(--neon-blue);
            color: var(--dark-bg);
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(0, 245, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            margin: 8px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Responsive Grid Improvements */
        @media (max-width: 1200px) {
            .container {
                padding: 0 16px;
            }
        }

        @media (max-width: 768px) {
            .stat-number {
                font-size: 2rem;
            }

            .modal-content {
                padding: 20px;
                margin: 10px;
            }

            .form-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .action-buttons {
                justify-content: center;
            }

            .neon-button {
                padding: 10px 16px;
                font-size: 12px;
                min-width: 80px;
            }
        }

        @media (max-width: 480px) {
            .notification {
                right: 10px;
                left: 10px;
                max-width: none;
            }

            .stat-card {
                padding: 16px;
            }

            .data-table th,
            .data-table td {
                padding: 8px 4px;
            }
        }

        /* Accessibility Improvements */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .focus-visible {
            outline: 2px solid var(--neon-blue);
            outline-offset: 2px;
        }

        /* Print/PDF Optimization */
        @media print {
            .hamburger,
            .mobile-nav,
            .notification,
            .modal {
                display: none !important;
            }

            body {
                background: white !important;
                color: black !important;
            }

            .cyber-card,
            .stat-card,
            .data-table {
                border: 1px solid #ccc !important;
                background: white !important;
            }

            .section {
                display: block !important;
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <!-- Notification Container -->
    <div id="notification" class="notification" role="alert" aria-live="polite"></div>

    <!-- Header -->
    <header class="cyber-border sticky top-0 z-50" role="banner">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <h1 class="text-2xl md:text-3xl font-bold orbitron neon-glow" style="color: var(--neon-blue);">
                        <i class="fas fa-rocket mr-2"></i>ColX Admin
                    </h1>
                    <div class="text-sm text-gray-400 hidden md:block">Enhanced Firebase Management Panel</div>
                </div>
                
                <!-- Desktop Navigation -->
                <nav class="desktop-nav flex space-x-2" role="navigation" aria-label="Main navigation">
                    <a href="#" class="nav-link active" onclick="showSection('dashboard')" role="button" tabindex="0">
                        <i class="fas fa-tachometer-alt"></i>
                        <span class="hidden lg:inline">Dashboard</span>
                    </a>
                    <a href="#" class="nav-link" onclick="showSection('users')" role="button" tabindex="0">
                        <i class="fas fa-users"></i>
                        <span class="hidden lg:inline">Users</span>
                    </a>
                    <a href="#" class="nav-link" onclick="showSection('news')" role="button" tabindex="0">
                        <i class="fas fa-newspaper"></i>
                        <span class="hidden lg:inline">News</span>
                    </a>
                    <a href="#" class="nav-link" onclick="showSection('notes')" role="button" tabindex="0">
                        <i class="fas fa-sticky-note"></i>
                        <span class="hidden lg:inline">Notes</span>
                    </a>
                    <a href="#" class="nav-link" onclick="showSection('suggestions')" role="button" tabindex="0">
                        <i class="fas fa-lightbulb"></i>
                        <span class="hidden lg:inline">Suggestions</span>
                    </a>
                </nav>

                <!-- Mobile Hamburger -->
                <div class="hamburger" onclick="toggleMobileNav()" role="button" tabindex="0" aria-label="Toggle navigation menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>

            <!-- Mobile Navigation -->
            <nav class="mobile-nav" id="mobileNav" role="navigation" aria-label="Mobile navigation">
                <a href="#" class="nav-link active" onclick="showSection('dashboard')" role="button">
                    <i class="fas fa-tachometer-alt"></i>Dashboard
                </a>
                <a href="#" class="nav-link" onclick="showSection('users')" role="button">
                    <i class="fas fa-users"></i>Users
                </a>
                <a href="#" class="nav-link" onclick="showSection('news')" role="button">
                    <i class="fas fa-newspaper"></i>News
                </a>
                <a href="#" class="nav-link" onclick="showSection('notes')" role="button">
                    <i class="fas fa-sticky-note"></i>Notes
                </a>
                <a href="#" class="nav-link" onclick="showSection('suggestions')" role="button">
                    <i class="fas fa-lightbulb"></i>Suggestions
                </a>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6">
        <!-- Dashboard Section -->
        <section id="dashboardSection" class="section active" role="main" aria-labelledby="dashboardTitle">
            <div class="flex flex-col md:flex-row md:items-center justify-between mb-8">
                <h2 id="dashboardTitle" class="text-2xl md:text-3xl font-bold orbitron mb-4 md:mb-0 neon-glow" style="color: var(--neon-blue);">
                    <i class="fas fa-chart-line mr-3"></i>Dashboard Overview
                </h2>
                <div class="flex items-center space-x-4">
                    <div class="text-sm text-gray-400">Last updated: <span id="lastUpdated">Loading...</span></div>
                    <button class="neon-button orange" onclick="refreshData()">
                        <i class="fas fa-sync-alt"></i>Refresh
                    </button>
                </div>
            </div>
            
            <!-- Statistics Cards -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="stat-card" role="region" aria-labelledby="totalUsersLabel">
                    <div class="stat-number orbitron" style="color: var(--neon-blue);" id="totalUsers">0</div>
                    <div id="totalUsersLabel" class="stat-label">Total Users</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 75%;"></div>
                    </div>
                </div>
                <div class="stat-card" role="region" aria-labelledby="totalNewsLabel">
                    <div class="stat-number orbitron" style="color: var(--neon-green);" id="totalNews">0</div>
                    <div id="totalNewsLabel" class="stat-label">News Posts</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 60%; background: linear-gradient(90deg, var(--neon-green), var(--neon-blue));"></div>
                    </div>
                </div>
                <div class="stat-card" role="region" aria-labelledby="totalNotesLabel">
                    <div class="stat-number orbitron" style="color: var(--neon-purple);" id="totalNotes">0</div>
                    <div id="totalNotesLabel" class="stat-label">Study Notes</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 85%; background: linear-gradient(90deg, var(--neon-purple), var(--neon-pink));"></div>
                    </div>
                </div>
                <div class="stat-card" role="region" aria-labelledby="totalSuggestionsLabel">
                    <div class="stat-number orbitron" style="color: var(--neon-pink);" id="totalSuggestions">0</div>
                    <div id="totalSuggestionsLabel" class="stat-label">Suggestions</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 45%; background: linear-gradient(90deg, var(--neon-pink), var(--neon-orange));"></div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Branch Distribution Chart -->
                <div class="cyber-card p-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-chart-pie mr-2" style="color: var(--neon-blue);"></i>
                        Branch Distribution
                    </h3>
                    <div class="chart-container">
                        <canvas id="branchChart"></canvas>
                    </div>
                </div>

                <!-- Activity Timeline Chart -->
                <div class="cyber-card p-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-chart-line mr-2" style="color: var(--neon-green);"></i>
                        Activity Timeline
                    </h3>
                    <div class="chart-container">
                        <canvas id="activityChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Quick Stats & Branch Details -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                <div class="cyber-card p-6 lg:col-span-2">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-graduation-cap mr-2" style="color: var(--neon-purple);"></i>
                        Branch Statistics
                    </h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4" id="branchStats">
                        <!-- Branch stats will be populated here -->
                    </div>
                </div>

                <div class="cyber-card p-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-clock mr-2" style="color: var(--neon-orange);"></i>
                        System Status
                    </h3>
                    <div class="space-y-4">
                        <div class="flex justify-between items-center">
                            <span class="text-sm">Firebase Connection</span>
                            <span class="badge verified">Online</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm">Data Sync</span>
                            <span class="badge approved">Active</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm">Server Status</span>
                            <span class="badge approved">Healthy</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm">Backup Status</span>
                            <span class="badge pending">Scheduled</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="cyber-card p-6">
                <div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
                    <h3 class="text-xl font-bold flex items-center mb-4 md:mb-0">
                        <i class="fas fa-history mr-2" style="color: var(--neon-blue);"></i>
                        Recent Activity
                    </h3>
                    <div class="filter-tags">
                        <span class="filter-tag active" data-filter="all">All</span>
                        <span class="filter-tag" data-filter="news">News</span>
                        <span class="filter-tag" data-filter="notes">Notes</span>
                        <span class="filter-tag" data-filter="suggestions">Suggestions</span>
                        <span class="filter-tag" data-filter="users">Users</span>
                    </div>
                </div>
                <div id="recentActivity" class="space-y-3 max-h-96 overflow-y-auto">
                    <!-- Recent activity will be populated here -->
                </div>
            </div>
        </section>

        <!-- Users Section -->
        <section id="usersSection" class="section" role="main" aria-labelledby="usersTitle">
            <div class="flex flex-col md:flex-row md:items-center justify-between mb-8">
                <h2 id="usersTitle" class="text-2xl md:text-3xl font-bold orbitron mb-4 md:mb-0 neon-glow" style="color: var(--neon-blue);">
                    <i class="fas fa-users mr-3"></i>Users Management
                </h2>
                <div class="flex flex-col md:flex-row gap-4">
                    <div class="search-container">
                        <input type="text" placeholder="Search users..." class="cyber-input search-input" id="userSearch">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                    <button class="neon-button" onclick="showModal('userModal')">
                        <i class="fas fa-plus"></i>Add User
                    </button>
                </div>
            </div>

            <div class="cyber-card p-6">
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Profile</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Branch</th>
                                <th>Year</th>
                                <th>Status</th>
                                <th>Join Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- Users data will be populated here -->
                        </tbody>
                    </table>
                </div>
                <div id="usersEmpty" class="empty-state" style="display: none;">
                    <i class="fas fa-users"></i>
                    <h3>No Users Found</h3>
                    <p>Start by adding your first user to the system.</p>
                </div>
            </div>
        </section>

        <!-- News Section -->
        <section id="newsSection" class="section" role="main" aria-labelledby="newsTitle">
            <div class="flex flex-col md:flex-row md:items-center justify-between mb-8">
                <h2 id="newsTitle" class="text-2xl md:text-3xl font-bold orbitron mb-4 md:mb-0 neon-glow" style="color: var(--neon-green);">
                    <i class="fas fa-newspaper mr-3"></i>News Management
                </h2>
                <div class="flex flex-col md:flex-row gap-4">
                    <div class="search-container">
                        <input type="text" placeholder="Search news..." class="cyber-input search-input" id="newsSearch">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                    <button class="neon-button green" onclick="showModal('newsModal')">
                        <i class="fas fa-plus"></i>Add News
                    </button>
                </div>
            </div>

            <div class="cyber-card p-6">
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Author</th>
                                <th>Category</th>
                                <th>Target Audience</th>
                                <th>Status</th>
                                <th>Views</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="newsTableBody">
                            <!-- News data will be populated here -->
                        </tbody>
                    </table>
                </div>
                <div id="newsEmpty" class="empty-state" style="display: none;">
                    <i class="fas fa-newspaper"></i>
                    <h3>No News Articles</h3>
                    <p>Create your first news article to keep users informed.</p>
                </div>
            </div>
        </section>

        <!-- Notes Section -->
        <section id="notesSection" class="section" role="main" aria-labelledby="notesTitle">
            <div class="flex flex-col md:flex-row md:items-center justify-between mb-8">
                <h2 id="notesTitle" class="text-2xl md:text-3xl font-bold orbitron mb-4 md:mb-0 neon-glow" style="color: var(--neon-purple);">
                    <i class="fas fa-sticky-note mr-3"></i>Notes Management
                </h2>
                <div class="flex flex-col md:flex-row gap-4">
                    <div class="search-container">
                        <input type="text" placeholder="Search notes..." class="cyber-input search-input" id="notesSearch">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                    <button class="neon-button purple" onclick="showModal('noteModal')">
                        <i class="fas fa-plus"></i>Add Note
                    </button>
                </div>
            </div>

            <div class="cyber-card p-6">
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Subject</th>
                                <th>Branch</th>
                                <th>Year</th>
                                <th>Author</th>
                                <th>Status</th>
                                <th>Helpful</th>
                                <th>Downloads</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="notesTableBody">
                            <!-- Notes data will be populated here -->
                        </tbody>
                    </table>
                </div>
                <div id="notesEmpty" class="empty-state" style="display: none;">
                    <i class="fas fa-sticky-note"></i>
                    <h3>No Study Notes</h3>
                    <p>Upload your first study note to help students learn.</p>
                </div>
            </div>
        </section>

        <!-- Suggestions Section -->
        <section id="suggestionsSection" class="section" role="main" aria-labelledby="suggestionsTitle">
            <div class="flex flex-col md:flex-row md:items-center justify-between mb-8">
                <h2 id="suggestionsTitle" class="text-2xl md:text-3xl font-bold orbitron mb-4 md:mb-0 neon-glow" style="color: var(--neon-pink);">
                    <i class="fas fa-lightbulb mr-3"></i>Suggestions Management
                </h2>
                <div class="flex flex-col md:flex-row gap-4">
                    <div class="search-container">
                        <input type="text" placeholder="Search suggestions..." class="cyber-input search-input" id="suggestionsSearch">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                    <button class="neon-button pink" onclick="showModal('suggestionModal')">
                        <i class="fas fa-plus"></i>Add Suggestion
                    </button>
                </div>
            </div>

            <div class="cyber-card p-6">
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Category</th>
                                <th>Author</th>
                                <th>Branch</th>
                                <th>Status</th>
                                <th>Priority</th>
                                <th>Upvotes</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="suggestionsTableBody">
                            <!-- Suggestions data will be populated here -->
                        </tbody>
                    </table>
                </div>
                <div id="suggestionsEmpty" class="empty-state" style="display: none;">
                    <i class="fas fa-lightbulb"></i>
                    <h3>No Suggestions</h3>
                    <p>Add the first suggestion to start collecting user feedback.</p>
                </div>
            </div>
        </section>
    </main>

    <!-- User Modal -->
    <div id="userModal" class="modal" role="dialog" aria-labelledby="userModalTitle" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="userModalTitle" class="modal-title">User Details</h3>
                <button class="close-btn" onclick="hideModal('userModal')" aria-label="Close modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="userForm" class="form-grid">
                <input type="hidden" id="userId">
                <div class="form-group">
                    <label class="form-label" for="userName">Name</label>
                    <input type="text" id="userName" class="cyber-input" required aria-describedby="userNameHelp">
                    <small id="userNameHelp" class="text-gray-400 text-sm">Enter the full name of the user</small>
                </div>
                <div class="form-group">
                    <label class="form-label" for="userEmail">Email</label>
                    <input type="email" id="userEmail" class="cyber-input" required aria-describedby="userEmailHelp">
                    <small id="userEmailHelp" class="text-gray-400 text-sm">Valid email address required</small>
                </div>
                <div class="form-group">
                    <label class="form-label" for="userBranch">Branch</label>
                    <select id="userBranch" class="cyber-select" required>
                        <option value="">Select Branch</option>
                        <option value="CSE">Computer Science Engineering</option>
                        <option value="ECE">Electronics & Communication</option>
                        <option value="ME">Mechanical Engineering</option>
                        <option value="EE">Electrical Engineering</option>
                        <option value="CE">Civil Engineering</option>
                        <option value="IT">Information Technology</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="userYear">Year</label>
                    <select id="userYear" class="cyber-select" required>
                        <option value="">Select Year</option>
                        <option value="1">1st Year</option>
                        <option value="2">2nd Year</option>
                        <option value="3">3rd Year</option>
                        <option value="4">4th Year</option>
                    </select>
                </div>
                <div class="form-group full-width">
                    <label class="form-label" for="userStatus">Status</label>
                    <select id="userStatus" class="cyber-select">
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                        <option value="suspended">Suspended</option>
                    </select>
                </div>
                <div class="full-width flex justify-end space-x-4 mt-6">
                    <button type="button" class="neon-button pink" onclick="hideModal('userModal')">Cancel</button>
                    <button type="submit" class="neon-button">Save User</button>
                </div>
            </form>
        </div>
    </div>

    <!-- News Modal -->
    <div id="newsModal" class="modal" role="dialog" aria-labelledby="newsModalTitle" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="newsModalTitle" class="modal-title">News Details</h3>
                <button class="close-btn" onclick="hideModal('newsModal')" aria-label="Close modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="newsForm" class="form-grid">
                <input type="hidden" id="newsId">
                <div class="form-group">
                    <label class="form-label" for="newsTitle">Title</label>
                    <input type="text" id="newsTitle" class="cyber-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="newsAuthor">Author</label>
                    <input type="text" id="newsAuthor" class="cyber-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="newsCategory">Category</label>
                    <select id="newsCategory" class="cyber-select" required>
                        <option value="">Select Category</option>
                        <option value="Academic">Academic</option>
                        <option value="Events">Events</option>
                        <option value="Announcements">Announcements</option>
                        <option value="Sports">Sports</option>
                        <option value="Cultural">Cultural</option>
                        <option value="Technical">Technical</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="newsTargetBranch">Target Branch</label>
                    <select id="newsTargetBranch" class="cyber-select">
                        <option value="ALL">All Branches</option>
                        <option value="CSE">Computer Science</option>
                        <option value="ECE">Electronics</option>
                        <option value="ME">Mechanical</option>
                        <option value="EE">Electrical</option>
                        <option value="CE">Civil</option>
                        <option value="IT">Information Technology</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="newsTargetYear">Target Year</label>
                    <select id="newsTargetYear" class="cyber-select">
                        <option value="ALL">All Years</option>
                        <option value="1">1st Year</option>
                        <option value="2">2nd Year</option>
                        <option value="3">3rd Year</option>
                        <option value="4">4th Year</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" id="newsVerified" class="mr-2">
                        Verified
                    </label>
                </div>
                <div class="form-group full-width">
                    <label class="form-label" for="newsContent">Content</label>
                    <textarea id="newsContent" class="cyber-textarea" rows="4" required></textarea>
                </div>
                <div class="full-width flex justify-end space-x-4 mt-6">
                    <button type="button" class="neon-button pink" onclick="hideModal('newsModal')">Cancel</button>
                    <button type="submit" class="neon-button green">Save News</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Note Modal -->
    <div id="noteModal" class="modal" role="dialog" aria-labelledby="noteModalTitle" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="noteModalTitle" class="modal-title">Note Details</h3>
                <button class="close-btn" onclick="hideModal('noteModal')" aria-label="Close modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="noteForm" class="form-grid">
                <input type="hidden" id="noteId">
                <input type="hidden" id="noteKey">
                <div class="form-group">
                    <label class="form-label" for="noteTitle">Title</label>
                    <input type="text" id="noteTitle" class="cyber-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="noteSubject">Subject</label>
                    <input type="text" id="noteSubject" class="cyber-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="noteAuthor">Author</label>
                    <input type="text" id="noteAuthor" class="cyber-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="noteBranch">Branch</label>
                    <select id="noteBranch" class="cyber-select" required>
                        <option value="">Select Branch</option>
                        <option value="CSE">Computer Science</option>
                        <option value="ECE">Electronics</option>
                        <option value="ME">Mechanical</option>
                        <option value="EE">Electrical</option>
                        <option value="CE">Civil</option>
                        <option value="IT">Information Technology</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="noteYear">Year</label>
                    <select id="noteYear" class="cyber-select" required>
                        <option value="">Select Year</option>
                        <option value="1">1st Year</option>
                        <option value="2">2nd Year</option>
                        <option value="3">3rd Year</option>
                        <option value="4">4th Year</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" id="noteApproved" class="mr-2">
                        Approved
                    </label>
                </div>
                <div class="form-group">
                    <label class="form-label" for="noteFileName">File Name</label>
                    <input type="text" id="noteFileName" class="cyber-input">
                </div>
                <div class="form-group">
                    <label class="form-label" for="noteFileSize">File Size (bytes)</label>
                    <input type="number" id="noteFileSize" class="cyber-input">
                </div>
                <div class="form-group">
                    <label class="form-label" for="noteHelpful">Helpful Count</label>
                    <input type="number" id="noteHelpful" class="cyber-input" value="0">
                </div>
                <div class="form-group full-width">
                    <label class="form-label" for="noteDescription">Description</label>
                    <textarea id="noteDescription" class="cyber-textarea" rows="3" required></textarea>
                </div>
                <div class="full-width flex justify-end space-x-4 mt-6">
                    <button type="button" class="neon-button pink" onclick="hideModal('noteModal')">Cancel</button>
                    <button type="submit" class="neon-button purple">Save Note</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Suggestion Modal -->
    <div id="suggestionModal" class="modal" role="dialog" aria-labelledby="suggestionModalTitle" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="suggestionModalTitle" class="modal-title">Suggestion Details</h3>
                <button class="close-btn" onclick="hideModal('suggestionModal')" aria-label="Close modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="suggestionForm" class="form-grid">
                <input type="hidden" id="suggestionId">
                <div class="form-group">
                    <label class="form-label" for="suggestionTitle">Title</label>
                    <input type="text" id="suggestionTitle" class="cyber-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="suggestionCategory">Category</label>
                    <select id="suggestionCategory" class="cyber-select" required>
                        <option value="general">General</option>
                        <option value="academic">Academic</option>
                        <option value="infrastructure">Infrastructure</option>
                        <option value="events">Events</option>
                        <option value="technical">Technical</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="suggestionAuthor">Author</label>
                    <input type="text" id="suggestionAuthor" class="cyber-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="suggestionAuthorBranch">Author Branch</label>
                    <select id="suggestionAuthorBranch" class="cyber-select" required>
                        <option value="">Select Branch</option>
                        <option value="CSE">Computer Science</option>
                        <option value="ECE">Electronics</option>
                        <option value="ME">Mechanical</option>
                        <option value="EE">Electrical</option>
                        <option value="CE">Civil</option>
                        <option value="IT">Information Technology</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="suggestionAuthorYear">Author Year</label>
                    <select id="suggestionAuthorYear" class="cyber-select" required>
                        <option value="">Select Year</option>
                        <option value="1">1st Year</option>
                        <option value="2">2nd Year</option>
                        <option value="3">3rd Year</option>
                        <option value="4">4th Year</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="suggestionStatus">Status</label>
                    <select id="suggestionStatus" class="cyber-select" required>
                        <option value="pending">Pending</option>
                        <option value="approved">Approved</option>
                        <option value="implemented">Implemented</option>
                        <option value="rejected">Rejected</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="suggestionPriority">Priority</label>
                    <select id="suggestionPriority" class="cyber-select" required>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="urgent">Urgent</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="suggestionUpvotes">Upvotes</label>
                    <input type="number" id="suggestionUpvotes" class="cyber-input" value="0">
                </div>
                <div class="form-group full-width">
                    <label class="form-label" for="suggestionText">Description</label>
                    <textarea id="suggestionText" class="cyber-textarea" rows="4" required></textarea>
                </div>
                <div class="full-width flex justify-end space-x-4 mt-6">
                    <button type="button" class="neon-button pink" onclick="hideModal('suggestionModal')">Cancel</button>
                    <button type="submit" class="neon-button pink">Save Suggestion</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Firebase SDKs and JavaScript -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
        import { getDatabase, ref, push, onValue, serverTimestamp, set, update, get, child, remove } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDjZIEEh2vId2AstnXJVL2Lsn4RdMPB_9Q",
            authDomain: "colx-cef6c.firebaseapp.com",
            databaseURL: "https://colx-cef6c-default-rtdb.firebaseio.com",
            projectId: "colx-cef6c",
            storageBucket: "colx-demo.appspot.com",
            messagingSenderId: "811776643206",
            appId: "1:811776643206:web:a28bac04abc0a6355a0107"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Global data storage
        let allUsers = {};
        let allNews = {};
        let allNotes = {};
        let allSuggestions = {};
        let branchChart, activityChart;

        // Utility functions
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification show ${type === 'error' ? 'error' : type === 'warning' ? 'warning' : ''}`;
            setTimeout(() => {
                notification.className = 'notification';
            }, 4000);
        }

        function formatDate(timestamp) {
            if (!timestamp) return 'N/A';
            return new Intl.DateTimeFormat('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            }).format(new Date(timestamp));
        }

        function formatFileSize(bytes) {
            if (!bytes) return 'N/A';
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(1024));
            return Math.round(bytes / Math.pow(1024, i) * 100) / 100 + ' ' + sizes[i];
        }

        // Navigation functions
        window.showSection = function(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionName + 'Section').classList.add('active');
            
            // Add active class to clicked nav link
            event.target.closest('.nav-link').classList.add('active');
            
            // Close mobile nav
            document.getElementById('mobileNav').classList.remove('active');
        };

        window.toggleMobileNav = function() {
            document.getElementById('mobileNav').classList.toggle('active');
        };

        // Modal functions
        window.showModal = function(modalId) {
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Clear forms
            if (modalId === 'userModal') clearUserForm();
            if (modalId === 'newsModal') clearNewsForm();
            if (modalId === 'noteModal') clearNoteForm();
            if (modalId === 'suggestionModal') clearSuggestionForm();
        };

        window.hideModal = function(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = 'auto';
        };

        // Form clearing functions
        function clearUserForm() {
            document.getElementById('userId').value = '';
            document.getElementById('userName').value = '';
            document.getElementById('userEmail').value = '';
            document.getElementById('userBranch').value = '';
            document.getElementById('userYear').value = '';
            document.getElementById('userStatus').value = 'active';
        }

        function clearNewsForm() {
            document.getElementById('newsId').value = '';
            document.getElementById('newsTitle').value = '';
            document.getElementById('newsAuthor').value = '';
            document.getElementById('newsCategory').value = '';
            document.getElementById('newsTargetBranch').value = 'ALL';
            document.getElementById('newsTargetYear').value = 'ALL';
            document.getElementById('newsVerified').checked = true;
            document.getElementById('newsContent').value = '';
        }

        function clearNoteForm() {
            document.getElementById('noteId').value = '';
            document.getElementById('noteKey').value = '';
            document.getElementById('noteTitle').value = '';
            document.getElementById('noteSubject').value = '';
            document.getElementById('noteAuthor').value = '';
            document.getElementById('noteBranch').value = '';
            document.getElementById('noteYear').value = '';
            document.getElementById('noteApproved').checked = false;
            document.getElementById('noteFileName').value = '';
            document.getElementById('noteFileSize').value = '';
            document.getElementById('noteHelpful').value = '0';
            document.getElementById('noteDescription').value = '';
        }

        function clearSuggestionForm() {
            document.getElementById('suggestionId').value = '';
            document.getElementById('suggestionTitle').value = '';
            document.getElementById('suggestionCategory').value = 'general';
            document.getElementById('suggestionAuthor').value = '';
            document.getElementById('suggestionAuthorBranch').value = '';
            document.getElementById('suggestionAuthorYear').value = '';
            document.getElementById('suggestionStatus').value = 'pending';
            document.getElementById('suggestionPriority').value = 'medium';
            document.getElementById('suggestionUpvotes').value = '0';
            document.getElementById('suggestionText').value = '';
        }

        // Data loading functions
        function loadAllData() {
            loadUsers();
            loadNews();
            loadNotes();
            loadSuggestions();
            updateLastUpdated();
        }

        function loadUsers() {
            const usersRef = ref(database, 'users');
            onValue(usersRef, (snapshot) => {
                allUsers = snapshot.val() || {};
                updateUsersTable();
                updateDashboard();
            });
        }

        function loadNews() {
            const newsRef = ref(database, 'news');
            onValue(newsRef, (snapshot) => {
                allNews = snapshot.val() || {};
                updateNewsTable();
                updateDashboard();
            });
        }

        function loadNotes() {
            const notesRef = ref(database, 'notes');
            onValue(notesRef, (snapshot) => {
                allNotes = snapshot.val() || {};
                updateNotesTable();
                updateDashboard();
            });
        }

        function loadSuggestions() {
            const suggestionsRef = ref(database, 'suggestions');
            onValue(suggestionsRef, (snapshot) => {
                allSuggestions = snapshot.val() || {};
                updateSuggestionsTable();
                updateDashboard();
            });
        }

        function updateLastUpdated() {
            document.getElementById('lastUpdated').textContent = formatDate(Date.now());
        }

        window.refreshData = function() {
            showNotification('Refreshing data...', 'info');
            loadAllData();
            setTimeout(() => {
                showNotification('Data refreshed successfully!');
            }, 1000);
        };

        // Dashboard update functions
        function updateDashboard() {
            updateStatistics();
            updateBranchStats();
            updateRecentActivity();
            updateCharts();
        }

        function updateStatistics() {
            const totalUsers = Object.keys(allUsers).length;
            const totalNews = Object.keys(allNews).length;
            
            let totalNotes = 0;
            Object.values(allNotes).forEach(branch => {
                if (typeof branch === 'object') {
                    Object.values(branch).forEach(year => {
                        if (typeof year === 'object') {
                            totalNotes += Object.keys(year).length;
                        }
                    });
                }
            });
            
            const totalSuggestions = Object.keys(allSuggestions).length;

            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('totalNews').textContent = totalNews;
            document.getElementById('totalNotes').textContent = totalNotes;
            document.getElementById('totalSuggestions').textContent = totalSuggestions;
        }

        function updateBranchStats() {
            const branchStats = {};
            const branches = ['CSE', 'ECE', 'ME', 'EE', 'CE', 'IT'];
            
            // Initialize branch counts
            branches.forEach(branch => {
                branchStats[branch] = 0;
            });
            
            // Count users by branch
            Object.values(allUsers).forEach(user => {
                if (user.branch && branchStats.hasOwnProperty(user.branch)) {
                    branchStats[user.branch]++;
                }
            });
            
            // Update UI
            const container = document.getElementById('branchStats');
            container.innerHTML = '';
            
            Object.entries(branchStats).forEach(([branch, count]) => {
                const div = document.createElement('div');
                div.className = 'text-center p-4 bg-black bg-opacity-40 rounded-lg border border-gray-700 hover:border-blue-500 transition-colors';
                div.innerHTML = `
                    <div class="text-2xl font-bold orbitron mb-2" style="color: var(--neon-blue);">${count}</div>
                    <div class="text-sm text-gray-400 font-medium">${branch}</div>
                    <div class="progress-bar mt-2">
                        <div class="progress-fill" style="width: ${Math.min(count / Math.max(...Object.values(branchStats)) * 100, 100)}%;"></div>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function updateRecentActivity() {
            const container = document.getElementById('recentActivity');
            container.innerHTML = '';
            
            const activities = [];
            
            // Get recent news
            Object.entries(allNews).forEach(([key, news]) => {
                if (news.timestamp) {
                    activities.push({
                        type: 'news',
                        title: news.title,
                        author: news.author,
                        timestamp: news.timestamp,
                        icon: 'fas fa-newspaper',
                        color: 'var(--neon-green)'
                    });
                }
            });
            
            // Get recent suggestions
            Object.entries(allSuggestions).forEach(([key, suggestion]) => {
                if (suggestion.timestamp) {
                    activities.push({
                        type: 'suggestion',
                        title: suggestion.title,
                        author: suggestion.author,
                        timestamp: suggestion.timestamp,
                        icon: 'fas fa-lightbulb',
                        color: 'var(--neon-pink)'
                    });
                }
            });

            // Get recent users
            Object.entries(allUsers).forEach(([uid, user]) => {
                if (user.joinDate || user.createdAt) {
                    activities.push({
                        type: 'user',
                        title: `New user: ${user.name}`,
                        author: user.branch || 'Unknown',
                        timestamp: user.joinDate || user.createdAt,
                        icon: 'fas fa-user-plus',
                        color: 'var(--neon-blue)'
                    });
                }
            });
            
            // Sort by timestamp and take last 15
            activities.sort((a, b) => b.timestamp - a.timestamp);
            
            if (activities.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-history"></i>
                        <h3>No Recent Activity</h3>
                        <p>Activity will appear here as users interact with the system.</p>
                    </div>
                `;
                return;
            }

            activities.slice(0, 15).forEach(activity => {
                const div = document.createElement('div');
                div.className = `flex items-center space-x-4 p-4 bg-black bg-opacity-30 rounded-lg border border-gray-800 hover:border-gray-600 transition-all activity-item`;
                div.setAttribute('data-type', activity.type);
                div.innerHTML = `
                    <div class="flex-shrink-0">
                        <i class="${activity.icon} text-xl" style="color: ${activity.color};"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="font-medium text-white truncate">${activity.title}</div>
                        <div class="text-sm text-gray-400 flex items-center mt-1">
                            <span class="truncate">${activity.author}</span>
                            <span class="mx-2">•</span>
                            <span class="flex-shrink-0">${formatDate(activity.timestamp)}</span>
                        </div>
                    </div>
                    <div class="flex-shrink-0">
                        <span class="badge ${activity.type === 'news' ? 'verified' : activity.type === 'suggestion' ? 'pending' : 'approved'}">${activity.type}</span>
                    </div>
                `;
                container.appendChild(div);
            });

            // Add filter functionality
            setupActivityFilters();
        }

        function setupActivityFilters() {
            document.querySelectorAll('.filter-tag').forEach(tag => {
                tag.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');
                    
                    // Update active tag
                    document.querySelectorAll('.filter-tag').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Filter activities
                    document.querySelectorAll('.activity-item').forEach(item => {
                        const type = item.getAttribute('data-type');
                        if (filter === 'all' || type === filter) {
                            item.style.display = 'flex';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
            });
        }

        function updateCharts() {
            updateBranchChart();
            updateActivityChart();
        }

        function updateBranchChart() {
            const ctx = document.getElementById('branchChart').getContext('2d');
            
            if (branchChart) {
                branchChart.destroy();
            }

            const branchData = {};
            const branches = ['CSE', 'ECE', 'ME', 'EE', 'CE', 'IT'];
            
            branches.forEach(branch => {
                branchData[branch] = 0;
            });
            
            Object.values(allUsers).forEach(user => {
                if (user.branch && branchData.hasOwnProperty(user.branch)) {
                    branchData[user.branch]++;
                }
            });

            branchChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: branches,
                    datasets: [{
                        data: Object.values(branchData),
                        backgroundColor: [
                            'rgba(0, 245, 255, 0.8)',
                            'rgba(191, 0, 255, 0.8)',
                            'rgba(255, 0, 128, 0.8)',
                            'rgba(0, 255, 65, 0.8)',
                            'rgba(255, 102, 0, 0.8)',
                            'rgba(255, 255, 0, 0.8)'
                        ],
                        borderColor: [
                            'rgba(0, 245, 255, 1)',
                            'rgba(191, 0, 255, 1)',
                            'rgba(255, 0, 128, 1)',
                            'rgba(0, 255, 65, 1)',
                            'rgba(255, 102, 0, 1)',
                            'rgba(255, 255, 0, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#ffffff',
                                font: {
                                    family: 'Rajdhani',
                                    size: 14
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateActivityChart() {
            const ctx = document.getElementById('activityChart').getContext('2d');
            
            if (activityChart) {
                activityChart.destroy();
            }

            // Get activity data for the last 7 days
            const last7Days = [];
            const activityData = {
                news: [],
                notes: [],
                suggestions: [],
                users: []
            };

            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                last7Days.push(date.toISOString().split('T')[0]);
                
                activityData.news.push(0);
                activityData.notes.push(0);
                activityData.suggestions.push(0);
                activityData.users.push(0);
            }

            // Count activities by date
            Object.values(allNews).forEach(news => {
                if (news.timestamp) {
                    const dateStr = new Date(news.timestamp).toISOString().split('T')[0];
                    const index = last7Days.indexOf(dateStr);
                    if (index !== -1) {
                        activityData.news[index]++;
                    }
                }
            });

            Object.values(allSuggestions).forEach(suggestion => {
                if (suggestion.timestamp) {
                    const dateStr = new Date(suggestion.timestamp).toISOString().split('T')[0];
                    const index = last7Days.indexOf(dateStr);
                    if (index !== -1) {
                        activityData.suggestions[index]++;
                    }
                }
            });

            Object.values(allUsers).forEach(user => {
                if (user.joinDate || user.createdAt) {
                    const dateStr = new Date(user.joinDate || user.createdAt).toISOString().split('T')[0];
                    const index = last7Days.indexOf(dateStr);
                    if (index !== -1) {
                        activityData.users[index]++;
                    }
                }
            });

            activityChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: last7Days.map(date => new Date(date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })),
                    datasets: [
                        {
                            label: 'News',
                            data: activityData.news,
                            borderColor: 'rgba(0, 255, 65, 1)',
                            backgroundColor: 'rgba(0, 255, 65, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'Users',
                            data: activityData.users,
                            borderColor: 'rgba(0, 245, 255, 1)',
                            backgroundColor: 'rgba(0, 245, 255, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'Suggestions',
                            data: activityData.suggestions,
                            borderColor: 'rgba(255, 0, 128, 1)',
                            backgroundColor: 'rgba(255, 0, 128, 0.1)',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#ffffff'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffffff',
                                font: {
                                    family: 'Rajdhani',
                                    size: 14
                                }
                            }
                        }
                    }
                }
            });
        }

        // Table update functions
        function updateUsersTable() {
            const tbody = document.getElementById('usersTableBody');
            const empty = document.getElementById('usersEmpty');
            tbody.innerHTML = '';
            
            const usersArray = Object.entries(allUsers);
            
            if (usersArray.length === 0) {
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            
            usersArray.forEach(([uid, user]) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-bold">
                                ${user.name ? user.name.charAt(0).toUpperCase() : 'U'}
                            </div>
                        </div>
                    </td>
                    <td class="font-medium">${user.name || 'N/A'}</td>
                    <td class="text-gray-300">${user.email || 'N/A'}</td>
                    <td><span class="badge verified">${user.branch || 'N/A'}</span></td>
                    <td><span class="badge approved">${user.year || 'N/A'}</span></td>
                    <td>
                        <span class="badge ${(user.status || 'active') === 'active' ? 'approved' : 'pending'}">
                            ${(user.status || 'active').charAt(0).toUpperCase() + (user.status || 'active').slice(1)}
                        </span>
                    </td>
                    <td class="text-gray-400">${formatDate(user.joinDate || user.createdAt)}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="neon-button" onclick="editUser('${uid}')" title="Edit user">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="neon-button pink" onclick="deleteUser('${uid}')" title="Delete user">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateNewsTable() {
            const tbody = document.getElementById('newsTableBody');
            const empty = document.getElementById('newsEmpty');
            tbody.innerHTML = '';
            
            const newsArray = Object.entries(allNews);
            
            if (newsArray.length === 0) {
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            
            newsArray.forEach(([key, news]) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="font-medium">${news.title || 'N/A'}</td>
                    <td class="text-gray-300">${news.author || 'N/A'}</td>
                    <td><span class="badge verified">${news.category || 'General'}</span></td>
                    <td class="text-gray-400">${news.targetBranch || 'ALL'} / ${news.targetYear || 'ALL'}</td>
                    <td>
                        <span class="badge ${news.verified ? 'verified' : 'pending'}">
                            ${news.verified ? 'Verified' : 'Unverified'}
                        </span>
                    </td>
                    <td class="text-gray-400">${Math.floor(Math.random() * 1000) + 50}</td>
                    <td class="text-gray-400">${formatDate(news.timestamp)}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="neon-button green" onclick="editNews('${key}')" title="Edit news">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="neon-button pink" onclick="deleteNews('${key}')" title="Delete news">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateNotesTable() {
            const tbody = document.getElementById('notesTableBody');
            const empty = document.getElementById('notesEmpty');
            tbody.innerHTML = '';
            
            let hasNotes = false;
            
            Object.entries(allNotes).forEach(([branch, years]) => {
                if (typeof years === 'object') {
                    Object.entries(years).forEach(([year, notes]) => {
                        if (typeof notes === 'object') {
                            Object.entries(notes).forEach(([key, note]) => {
                                hasNotes = true;
                                const row = document.createElement('tr');
                                row.innerHTML = `
                                    <td class="font-medium">${note.title || 'N/A'}</td>
                                    <td class="text-gray-300">${note.subject || 'N/A'}</td>
                                    <td><span class="badge verified">${branch}</span></td>
                                    <td><span class="badge approved">${year}</span></td>
                                    <td class="text-gray-300">${note.author || 'N/A'}</td>
                                    <td>
                                        <span class="badge ${note.approved ? 'approved' : 'pending'}">
                                            ${note.approved ? 'Approved' : 'Pending'}
                                        </span>
                                    </td>
                                    <td class="text-gray-400">${note.helpful || 0}</td>
                                    <td class="text-gray-400">${Math.floor(Math.random() * 500) + 10}</td>
                                    <td>
                                        <div class="action-buttons">
                                            <button class="neon-button purple" onclick="editNote('${branch}', '${year}', '${key}')" title="Edit note">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="neon-button pink" onclick="deleteNote('${branch}', '${year}', '${key}')" title="Delete note">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                `;
                                tbody.appendChild(row);
                            });
                        }
                    });
                }
            });
            
            if (!hasNotes) {
                empty.style.display = 'block';
            } else {
                empty.style.display = 'none';
            }
        }

        function updateSuggestionsTable() {
            const tbody = document.getElementById('suggestionsTableBody');
            const empty = document.getElementById('suggestionsEmpty');
            tbody.innerHTML = '';
            
            const suggestionsArray = Object.entries(allSuggestions);
            
            if (suggestionsArray.length === 0) {
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            
            suggestionsArray.forEach(([key, suggestion]) => {
                const row = document.createElement('tr');
                const priorityColor = {
                    'low': 'approved',
                    'medium': 'pending',
                    'high': 'verified',
                    'urgent': 'implemented'
                };
                
                row.innerHTML = `
                    <td class="font-medium">${suggestion.title || 'N/A'}</td>
                    <td class="text-gray-300">${suggestion.category || 'general'}</td>
                    <td class="text-gray-300">${suggestion.author || 'N/A'}</td>
                    <td><span class="badge verified">${suggestion.authorBranch || 'N/A'}</span></td>
                    <td>
                        <span class="badge ${suggestion.status === 'approved' ? 'approved' : suggestion.status === 'implemented' ? 'implemented' : 'pending'}">
                            ${(suggestion.status || 'pending').charAt(0).toUpperCase() + (suggestion.status || 'pending').slice(1)}
                        </span>
                    </td>
                    <td>
                        <span class="badge ${priorityColor[suggestion.priority || 'medium']}">
                            ${(suggestion.priority || 'medium').charAt(0).toUpperCase() + (suggestion.priority || 'medium').slice(1)}
                        </span>
                    </td>
                    <td class="text-gray-400">${suggestion.upvotes || 0}</td>
                    <td class="text-gray-400">${formatDate(suggestion.timestamp)}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="neon-button pink" onclick="editSuggestion('${key}')" title="Edit suggestion">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="neon-button pink" onclick="deleteSuggestion('${key}')" title="Delete suggestion">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // CRUD Operations
        window.editUser = function(uid) {
            const user = allUsers[uid];
            if (user) {
                document.getElementById('userId').value = uid;
                document.getElementById('userName').value = user.name || '';
                document.getElementById('userEmail').value = user.email || '';
                document.getElementById('userBranch').value = user.branch || '';
                document.getElementById('userYear').value = user.year || '';
                document.getElementById('userStatus').value = user.status || 'active';
                showModal('userModal');
            }
        };

        window.deleteUser = function(uid) {
            if (confirm('Are you sure you want to delete this user?')) {
                const userRef = ref(database, `users/${uid}`);
                remove(userRef).then(() => {
                    showNotification('User deleted successfully!');
                }).catch((error) => {
                    showNotification('Error deleting user: ' + error.message, 'error');
                });
            }
        };

        window.editNews = function(key) {
            const news = allNews[key];
            if (news) {
                document.getElementById('newsId').value = key;
                document.getElementById('newsTitle').value = news.title || '';
                document.getElementById('newsAuthor').value = news.author || '';
                document.getElementById('newsCategory').value = news.category || '';
                document.getElementById('newsTargetBranch').value = news.targetBranch || 'ALL';
                document.getElementById('newsTargetYear').value = news.targetYear || 'ALL';
                document.getElementById('newsVerified').checked = news.verified || false;
                document.getElementById('newsContent').value = news.content || '';
                showModal('newsModal');
            }
        };

        window.deleteNews = function(key) {
            if (confirm('Are you sure you want to delete this news article?')) {
                const newsRef = ref(database, `news/${key}`);
                remove(newsRef).then(() => {
                    showNotification('News article deleted successfully!');
                }).catch((error) => {
                    showNotification('Error deleting news: ' + error.message, 'error');
                });
            }
        };

        window.editNote = function(branch, year, key) {
            const note = allNotes[branch] && allNotes[branch][year] && allNotes[branch][year][key];
            if (note) {
                document.getElementById('noteId').value = `${branch}/${year}/${key}`;
                document.getElementById('noteKey').value = key;
                document.getElementById('noteTitle').value = note.title || '';
                document.getElementById('noteSubject').value = note.subject || '';
                document.getElementById('noteAuthor').value = note.author || '';
                document.getElementById('noteBranch').value = branch;
                document.getElementById('noteYear').value = year;
                document.getElementById('noteApproved').checked = note.approved || false;
                document.getElementById('noteFileName').value = note.fileName || '';
                document.getElementById('noteFileSize').value = note.fileSize || '';
                document.getElementById('noteHelpful').value = note.helpful || 0;
                document.getElementById('noteDescription').value = note.description || '';
                showModal('noteModal');
            }
        };

        window.deleteNote = function(branch, year, key) {
            if (confirm('Are you sure you want to delete this note?')) {
                const noteRef = ref(database, `notes/${branch}/${year}/${key}`);
                remove(noteRef).then(() => {
                    showNotification('Note deleted successfully!');
                }).catch((error) => {
                    showNotification('Error deleting note: ' + error.message, 'error');
                });
            }
        };

        window.editSuggestion = function(key) {
            const suggestion = allSuggestions[key];
            if (suggestion) {
                document.getElementById('suggestionId').value = key;
                document.getElementById('suggestionTitle').value = suggestion.title || '';
                document.getElementById('suggestionCategory').value = suggestion.category || 'general';
                document.getElementById('suggestionAuthor').value = suggestion.author || '';
                document.getElementById('suggestionAuthorBranch').value = suggestion.authorBranch || '';
                document.getElementById('suggestionAuthorYear').value = suggestion.authorYear || '';
                document.getElementById('suggestionStatus').value = suggestion.status || 'pending';
                document.getElementById('suggestionPriority').value = suggestion.priority || 'medium';
                document.getElementById('suggestionUpvotes').value = suggestion.upvotes || 0;
                document.getElementById('suggestionText').value = suggestion.text || '';
                showModal('suggestionModal');
            }
        };

        window.deleteSuggestion = function(key) {
            if (confirm('Are you sure you want to delete this suggestion?')) {
                const suggestionRef = ref(database, `suggestions/${key}`);
                remove(suggestionRef).then(() => {
                    showNotification('Suggestion deleted successfully!');
                }).catch((error) => {
                    showNotification('Error deleting suggestion: ' + error.message, 'error');
                });
            }
        };

        // Form submission handlers
        document.getElementById('userForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userId = document.getElementById('userId').value;
            const userData = {
                name: document.getElementById('userName').value,
                email: document.getElementById('userEmail').value,
                branch: document.getElementById('userBranch').value,
                year: document.getElementById('userYear').value,
                status: document.getElementById('userStatus').value,
                updatedAt: Date.now()
            };

            if (!userId) {
                userData.createdAt = Date.now();
                userData.joinDate = Date.now();
            }

            const userRef = userId ? ref(database, `users/${userId}`) : push(ref(database, 'users'));
            const operation = userId ? set(userRef, userData) : set(userRef, userData);

            operation.then(() => {
                showNotification(userId ? 'User updated successfully!' : 'User created successfully!');
                hideModal('userModal');
            }).catch((error) => {
                showNotification('Error saving user: ' + error.message, 'error');
            });
        });

        document.getElementById('newsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newsId = document.getElementById('newsId').value;
            const newsData = {
                title: document.getElementById('newsTitle').value,
                author: document.getElementById('newsAuthor').value,
                category: document.getElementById('newsCategory').value,
                targetBranch: document.getElementById('newsTargetBranch').value,
                targetYear: document.getElementById('newsTargetYear').value,
                verified: document.getElementById('newsVerified').checked,
                content: document.getElementById('newsContent').value,
                timestamp: Date.now()
            };

            const newsRef = newsId ? ref(database, `news/${newsId}`) : push(ref(database, 'news'));
            const operation = set(newsRef, newsData);

            operation.then(() => {
                showNotification(newsId ? 'News updated successfully!' : 'News created successfully!');
                hideModal('newsModal');
            }).catch((error) => {
                showNotification('Error saving news: ' + error.message, 'error');
            });
        });

        document.getElementById('noteForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const noteId = document.getElementById('noteId').value;
            const branch = document.getElementById('noteBranch').value;
            const year = document.getElementById('noteYear').value;
            const key = document.getElementById('noteKey').value;

            const noteData = {
                title: document.getElementById('noteTitle').value,
                subject: document.getElementById('noteSubject').value,
                author: document.getElementById('noteAuthor').value,
                approved: document.getElementById('noteApproved').checked,
                fileName: document.getElementById('noteFileName').value,
                fileSize: parseInt(document.getElementById('noteFileSize').value) || 0,
                helpful: parseInt(document.getElementById('noteHelpful').value) || 0,
                description: document.getElementById('noteDescription').value,
                timestamp: Date.now()
            };

            const noteRef = noteId ? ref(database, `notes/${noteId}`) : push(ref(database, `notes/${branch}/${year}`));
            const operation = set(noteRef, noteData);

            operation.then(() => {
                showNotification(noteId ? 'Note updated successfully!' : 'Note created successfully!');
                hideModal('noteModal');
            }).catch((error) => {
                showNotification('Error saving note: ' + error.message, 'error');
            });
        });

        document.getElementById('suggestionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const suggestionId = document.getElementById('suggestionId').value;
            const suggestionData = {
                title: document.getElementById('suggestionTitle').value,
                category: document.getElementById('suggestionCategory').value,
                author: document.getElementById('suggestionAuthor').value,
                authorBranch: document.getElementById('suggestionAuthorBranch').value,
                authorYear: document.getElementById('suggestionAuthorYear').value,
                status: document.getElementById('suggestionStatus').value,
                priority: document.getElementById('suggestionPriority').value,
                upvotes: parseInt(document.getElementById('suggestionUpvotes').value) || 0,
                text: document.getElementById('suggestionText').value,
                timestamp: Date.now()
            };

            const suggestionRef = suggestionId ? ref(database, `suggestions/${suggestionId}`) : push(ref(database, 'suggestions'));
            const operation = set(suggestionRef, suggestionData);

            operation.then(() => {
                showNotification(suggestionId ? 'Suggestion updated successfully!' : 'Suggestion created successfully!');
                hideModal('suggestionModal');
            }).catch((error) => {
                showNotification('Error saving suggestion: ' + error.message, 'error');
            });
        });

        // Search functionality
        document.getElementById('userSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#usersTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        document.getElementById('newsSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#newsTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        document.getElementById('notesSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#notesTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        document.getElementById('suggestionsSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#suggestionsTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Keyboard accessibility
        document.addEventListener('keydown', function(e) {
            // Close modals with Escape key
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal.active').forEach(modal => {
                    modal.classList.remove('active');
                    document.body.style.overflow = 'auto';
                });
            }

            // Toggle mobile nav with m key
            if (e.key === 'm' && e.ctrlKey) {
                e.preventDefault();
                toggleMobileNav();
            }
        });

        // Focus management
        document.querySelectorAll('.nav-link, .neon-button, .cyber-input, .cyber-select').forEach(element => {
            element.addEventListener('focus', function() {
                this.classList.add('focus-visible');
            });
            
            element.addEventListener('blur', function() {
                this.classList.remove('focus-visible');
            });
        });

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadAllData();
            showNotification('ColX Admin Panel initialized successfully!');
        });

        // Handle clicks outside modals to close them
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                    document.body.style.overflow = 'auto';
                }
            });
        });

        // Error handling for Firebase connection
        window.addEventListener('offline', function() {
            showNotification('You are offline. Changes may not be saved.', 'warning');
        });

        window.addEventListener('online', function() {
            showNotification('Connection restored!');
            loadAllData();
        });

    </script>
</body>
</html>
